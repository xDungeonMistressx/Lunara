<!DOCTYPE html>
<head>
  <meta charset="utf-8" />
  <title>Lunara</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <link rel="stylesheet" href="leaflet-search.min.css" />
<style>
  /* Karte nimmt immer den gesamten Bildschirm */
  #map { 
    height: 100vh; 
    width: 100vw; 
  }

  /* ===== Suchfeld ===== */
  .leaflet-control-search {
    font-size: 16px;
    max-width: 280px;
    background-color: #ffffff;
    border-radius: 30px;          /* rundes Feld */
    box-shadow: 0 2px 6px rgba(0,0,0,0.3);
    overflow: hidden;
    display: flex;
    align-items: center;
  }

  .leaflet-control-search input {
    flex: 1;                      /* nimmt den Platz ein */
    height: 36px;
    padding: 0 12px;
    font-size: 15px;
    border: none;
    outline: none;
  }

  .leaflet-control-search .search-button {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 36px;
    width: 40px;
    background-color: #007bff;    /* blau */
    color: white;
    font-size: 18px;
    cursor: pointer;
    text-decoration: none;
  }

  .leaflet-control-search .search-button::before {
    content: "üîç";
  }

  .leaflet-control-search .search-button:hover {
    background-color: #0056b3;    /* dunkler Blau-Ton */
  }

  /* ===== Layer-Auswahl ===== */
  .leaflet-control-layers {
    font-size: 15px;
    background-color: rgba(255, 255, 255, 0.9);
    border-radius: 8px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.3);
  }

  .leaflet-control-layers label {
    padding: 6px 10px;
    cursor: pointer;
  }

  .leaflet-control-layers input {
    width: 18px;
    height: 18px;
  }

  .leaflet-control-layers label:hover {
    background: #f0f0f0;
    border-radius: 4px;
  }

  /* ===== Mobile Optimierung ===== */
  @media (max-width: 768px) {
    .leaflet-control-search {
      max-width: 200px;
      font-size: 14px;
    }
    .leaflet-control-search input {
      height: 32px;
      font-size: 14px;
    }
    .leaflet-control-search .search-button {
      height: 32px;
      width: 36px;
      font-size: 16px;
    }
    .leaflet-control-layers {
      font-size: 14px;
    }
  }

  @media (max-width: 480px) {
    .leaflet-control-search {
      max-width: 160px;          /* schmaleres Feld auf sehr kleinen Screens */
    }
  }
</style>

</head>
<body>
  <div id="map"></div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script src="leaflet-search.min.js"></script>
  <script>
    // === Basis-Setup ===
    var w = 3840, h = 2160; // Bildgr√∂√üe anpassen!
    var bounds = [[0,0], [h, w]];

    var map = L.map('map', {
      crs: L.CRS.Simple,
      minZoom: -1
    });

    // === Hintergrund-Layer ===
    var terrain = L.imageOverlay('terrain.jpg', bounds);
    var politics = L.imageOverlay('grenzen.jpg', bounds);

    var baseMaps = {
      "Gel√§nde": terrain,
      "Politische Karte": politics
    };

    // === Kategorien-LayerGroups ===
    var categories = {
      "Orte": L.layerGroup(),
      "Gebiete": L.layerGroup(),
      "W√§lder": L.layerGroup(),
      "Gebirge": L.layerGroup(),
      "Gew√§sser": L.layerGroup(),
      "Routen": L.layerGroup()
    };

    var overlayMaps = {
      "Orte": categories["Orte"],
      "Gebiete": categories["Gebiete"],
      "W√§lder": categories["W√§lder"],
      "Gebirge": categories["Gebirge"],
      "Gew√§sser": categories["Gew√§sser"],
      "Routen": categories["Routen"]
    };

// === Marker erstellen ===
function createMarker(data) {
  var marker = L.circleMarker(data.coords, {
    radius: 8,
    color: 'black',
    weight: 2,
    fillColor: data.color,
    fillOpacity: 1
  }).bindPopup('<b>' + data.title + '</b><br>' + data.description);

  // statt "name" direkt "title" verwenden ‚Üí einfacher
  marker.feature = { properties: { title: data.title } };

  marker.addTo(categories[data.category]);
  return marker;
}

// === Marker laden aus JSON ===
var allMarkers = [];
fetch('markers.json')
  .then(response => response.json())
  .then(data => {
    data.forEach(item => {
      var m = createMarker(item);
      allMarkers.push(m);
    });

    // Suche aktivieren
    var searchControl = new L.Control.Search({
      layer: L.featureGroup(allMarkers), // alle Marker in einer Gruppe
      propertyName: 'title',             // durchsucht "title"
      initial: false,
      zoom: 2,
      marker: false
    });
    map.addControl(searchControl);
  });

    // === Layer-Steuerung & Standardanzeige ===
    L.control.layers(baseMaps, overlayMaps).addTo(map);
    terrain.addTo(map);
    categories["Orte"].addTo(map);
    categories["Gebiete"].addTo(map);
    categories["W√§lder"].addTo(map);
    categories["Gebirge"].addTo(map);
    categories["Gew√§sser"].addTo(map);
    
    map.fitBounds(bounds);

    // === Klick-Koordinaten anzeigen ===
//    map.on('click', function(e) {
//      alert("Koordinaten: " + e.latlng);
//      console.log("Koordinaten:", e.latlng);
//    });
  </script>
</body>

</html>














